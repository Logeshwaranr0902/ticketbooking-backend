version: '3.8'

services:
  movie-db:
    container_name: movie-db-container
    image: 'mysql:${MYSQL_VERSION}'
    environment:
      MYSQL_DATABASE: ${MOVIE_DB_NAME}
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
    ports:
      - '3307:3306'
    networks:
      - ticket-booking-net
    volumes:
      - movie-data:/var/lib/mysql

  theater-db:
    container_name: theater-db-container
    image: 'mysql:${MYSQL_VERSION}'
    environment:
      MYSQL_DATABASE: ${THEATER_DB_NAME}
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
    ports:
      - '3308:3306'
    networks:
      - ticket-booking-net
    volumes:
      - theater-data:/var/lib/mysql

  show-db:
    container_name: show-db-container
    image: 'mysql:${MYSQL_VERSION}'
    environment:
      MYSQL_DATABASE: ${SHOW_DB_NAME}
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
    ports:
      - '3309:3306'
    networks:
      - ticket-booking-net
    volumes:
      - show-data:/var/lib/mysql

  booking-db:
    container_name: booking-db-container
    image: 'mysql:${MYSQL_VERSION}'
    environment:
      MYSQL_DATABASE: ${BOOKING_DB_NAME}
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
    ports:
      - '3310:3306'
    networks:
      - ticket-booking-net
    volumes:
      - booking-data:/var/lib/mysql

  keycloak:
    container_name: keycloak-container
    image: quay.io/keycloak/keycloak:24.0
    command: start-dev
    environment:
      KC_DB: ${KEYCLOAK_DB}
      KEYCLOAK_ADMIN: ${KEYCLOAK_ADMIN_USER}
      KEYCLOAK_ADMIN_PASSWORD: ${KEYCLOAK_ADMIN_PASSWORD}
    ports:
      - '${KEYCLOAK_PORT}:8080'
    networks:
      - ticket-booking-net
    volumes:
      - keycloak-data:/opt/keycloak/data

networks:
  ticket-booking-net:
    driver: bridge

volumes:
  movie-data:
  theater-data:
  show-data:
  booking-data:
  keycloak-data:
